<?xml version="1.0" encoding="UTF-8"?>

<chapter xml:id="ch-tutorials" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Tutorials</title>
  <introduction>
    <p>
      Step-by-step guides for working with your math journal, deploying to GitHub Pages, and adding content.
    </p>
  </introduction>

  <section xml:id="sec-local-setup">
    <title>Getting Started</title>
    <idx>setup</idx>
    <idx>development</idx>
    
    <introduction>
      <p>
        <term>Note ID:</term> 202511100005 | 
        <term>Tags:</term> tutorial, setup, development
      </p>
      <p>
        Learn how to work with your PreTeXt math journal and build your mathematical knowledge base.
      </p>
    </introduction>

    <subsection xml:id="subsec-prerequisites">
      <title>Prerequisites</title>
      <p>
        Before you begin, make sure you have these installed:
      </p>
      <ul>
        <li>
          <p>
            <term>Python</term> (version 3.10 or higher) <mdash/> Download from 
            <url href="https://python.org">python.org</url>. 
            Check with <c>python --version</c> in your terminal.
          </p>
        </li>
        <li>
          <p>
            <term>PreTeXt CLI</term> <mdash/> Install with <c>pip install pretext</c>
          </p>
        </li>
        <li>
          <p>
            <term>Git</term> (for version control and deployment) <mdash/> Download from 
            <url href="https://git-scm.com">git-scm.com</url>. 
            Check with <c>git --version</c>.
          </p>
        </li>
      </ul>
    </subsection>

    <subsection xml:id="subsec-building-project">
      <title>Building Your Project</title>
      <p>
        The project uses a custom build script that compiles PreTeXt and injects custom CSS styling:
      </p>
      <pre>
        ./build.sh
      </pre>
      <p>
        This script:
      </p>
      <ul>
        <li><p>Runs <c>pretext build web</c> to generate HTML</p></li>
        <li><p>Copies custom CSS and assets to <c>output/web/</c></p></li>
        <li><p>Injects custom styling into all HTML files</p></li>
      </ul>
      <p>
        To view your journal locally, the PreTeXt Server workflow is already running on port 5000. 
        Just open the Webview pane in Replit, or navigate to <c>http://localhost:5000</c> in your browser.
      </p>
      <p>
        <alert>Important:</alert> Always use <c>./build.sh</c> instead of <c>pretext build</c> directly to ensure 
        your custom styling is applied!
      </p>
    </subsection>
  </section>

  <section xml:id="sec-github-deployment">
    <title>Deploying to GitHub Pages</title>
    <idx>deployment</idx>
    <idx>GitHub Pages</idx>
    
    <introduction>
      <p>
        Make your math journal publicly accessible by deploying to GitHub Pages. Your site will be available at <c>https://username.github.io/repository-name/</c>
      </p>
    </introduction>

    <subsection xml:id="subsec-create-github-repo">
      <title>Step 1: Create a GitHub Repository</title>
      <ol>
        <li>
          <p>Go to <url href="https://github.com">github.com</url> and sign in</p>
        </li>
        <li>
          <p>Click the <c>+</c> button in the top right, then <c>New repository</c></p>
        </li>
        <li>
          <p>Name your repository (e.g., <c>my-zettelkasten</c>)</p>
        </li>
        <li>
          <p>Choose <term>Public</term> (required for free GitHub Pages)</p>
        </li>
        <li>
          <p>Do NOT initialize with README (we already have files)</p>
        </li>
        <li>
          <p>Click <c>Create repository</c></p>
        </li>
      </ol>
    </subsection>

    <subsection xml:id="subsec-connect-repo">
      <title>Step 2: Connect Your Project to GitHub</title>
      <p>
        In your terminal (Shell in Replit), run these commands:
      </p>
      <pre>
        git init
        git add .
        git commit -m "Initial commit: PreTeXt math journal"
        git branch -M main
        git remote add origin https://github.com/username/repository-name.git
        git push -u origin main
      </pre>
      <p>
        Replace <c>username</c> and <c>repository-name</c> with your actual GitHub username and repository name.
      </p>
      <p>
        <alert>Note:</alert> You will be prompted for your GitHub username and password. For the password, use a 
        <url href="https://github.com/settings/tokens">Personal Access Token</url> (not your actual password).
      </p>
    </subsection>

    <subsection xml:id="subsec-deploy-to-pages">
      <title>Step 3: Deploy to GitHub Pages</title>
      <p>
        Choose one of two deployment methods: automatic GitHub Actions or manual git subtree.
      </p>

      <paragraphs>
        <title>Method A: Using GitHub Actions (Recommended)</title>
        <p>
          This method automatically deploys your site every time you push changes to GitHub.
        </p>
        <p>
          First, create the workflow directory:
        </p>
        <pre>
          mkdir -p .github/workflows
        </pre>
        <p>
          Create a file <c>.github/workflows/deploy.yml</c> with this content:
        </p>
        <pre>
name: Deploy to GitHub Pages

on:
  push:
    branches: [main]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: Install PreTeXt CLI
        run: pip install pretext
      
      - name: Build with custom styling
        run: chmod +x build.sh &amp;&amp; ./build.sh
      
      - name: Upload to GitHub Pages
        uses: actions/upload-pages-artifact@v3
        with:
          path: 'output/web'
      
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
        </pre>
        <p>
          Then configure GitHub Pages:
        </p>
        <ol>
          <li><p>Go to repository <c>Settings</c> → <c>Pages</c></p></li>
          <li><p>Under <c>Source</c>, select <c>GitHub Actions</c></p></li>
        </ol>
        <p>
          Now commit and push your workflow file:
        </p>
        <pre>
          git add .github/workflows/deploy.yml
          git commit -m "Add GitHub Actions deployment"
          git push
        </pre>
        <p>
          Your site will automatically build and deploy! Check the <c>Actions</c> tab in GitHub to monitor progress.
        </p>
        <p>
          Your site will be live at <c>https://username.github.io/repository-name/</c>
        </p>
      </paragraphs>

      <paragraphs>
        <title>Method B: Manual Deployment (Alternative)</title>
        <p>
          If you prefer manual control, you can build locally and deploy manually:
        </p>
        <pre>
          ./build.sh
          git add output/web
          git commit -m "Build for deployment"
          git subtree push --prefix output/web origin gh-pages
        </pre>
        <p>
          Then configure GitHub Pages to use the <c>gh-pages</c> branch:
        </p>
        <ol>
          <li><p>Go to <c>Settings</c> → <c>Pages</c></p></li>
          <li><p>Under <c>Source</c>, select <c>Deploy from a branch</c></p></li>
          <li><p>Select branch <c>gh-pages</c> and folder <c>/ (root)</c></p></li>
        </ol>
        <p>
          <alert>Note:</alert> Method A (GitHub Actions) is recommended for automatic updates!
        </p>
      </paragraphs>
    </subsection>

    <subsection xml:id="subsec-updating-site">
      <title>Step 4: Updating Your Live Site</title>
      <p>
        After making changes to your math journal source files:
      </p>
      <pre>
        ./build.sh
        git add .
        git commit -m "Add new topology notes"
        git push
      </pre>
      <p>
        <term>Using GitHub Actions (Method A):</term> Your site updates automatically! GitHub will run the build script and deploy within 1-2 minutes.
      </p>
      <p>
        <term>Using Manual Deployment (Method B):</term> Run the git subtree command again:
      </p>
      <pre>
        git subtree push --prefix output/web origin gh-pages
      </pre>
    </subsection>
  </section>

  <section xml:id="sec-adding-content">
    <title>Adding Content Easily</title>
    <idx>content creation</idx>
    <idx>writing notes</idx>
    
    <introduction>
      <p>
        Best practices for adding mathematical notes to your Zettelkasten journal.
      </p>
    </introduction>

    <subsection xml:id="subsec-file-structure">
      <title>Understanding the File Structure</title>
      <p>
        Your content is organized in the <c>source/</c> directory:
      </p>
      <ul>
        <li>
          <p>
            <c>main.ptx</c> <mdash/> Main document structure (usually don't edit)
          </p>
        </li>
        <li>
          <p>
            <c>ch-prototypes.ptx</c> <mdash/> Experimental notes and explorations
          </p>
        </li>
        <li>
          <p>
            <c>ch-tutorials.ptx</c> <mdash/> Step-by-step learning guides
          </p>
        </li>
        <li>
          <p>
            <c>ch-explanations.ptx</c> <mdash/> Conceptual explanations
          </p>
        </li>
        <li>
          <p>
            <c>ch-reference.ptx</c> <mdash/> Quick reference definitions
          </p>
        </li>
        <li>
          <p>
            <c>backmatter.ptx</c> <mdash/> Bibliography and index
          </p>
        </li>
      </ul>
    </subsection>

    <subsection xml:id="subsec-adding-new-note">
      <title>Adding a New Note</title>
      <p>
        To add a new mathematical note:
      </p>
      <ol>
        <li>
          <p>
            Choose the appropriate chapter file based on the Diataxis framework:
          </p>
          <ul>
            <li><p><term>Prototype</term> <mdash/> New explorations, experiments</p></li>
            <li><p><term>Tutorial</term> <mdash/> Learning-oriented guides</p></li>
            <li><p><term>Explanation</term> <mdash/> Understanding-oriented content</p></li>
            <li><p><term>Reference</term> <mdash/> Information-oriented quick lookup</p></li>
          </ul>
        </li>
        <li>
          <p>
            Open the chapter file and add a new <c>&lt;section&gt;</c>:
          </p>
          <pre>
&lt;section xml:id="sec-your-topic"&gt;
  &lt;title&gt;Your Topic Title&lt;/title&gt;
  &lt;idx&gt;keyword&lt;/idx&gt;
  
  &lt;p&gt;
    Your mathematical content here...
  &lt;/p&gt;
  
  &lt;definition xml:id="def-example"&gt;
    &lt;statement&gt;
      &lt;p&gt;
        A &lt;term&gt;metric space&lt;/term&gt; is...
      &lt;/p&gt;
    &lt;/statement&gt;
  &lt;/definition&gt;
&lt;/section&gt;
          </pre>
        </li>
        <li>
          <p>
            Build and preview your changes:
          </p>
          <pre>
            ./build.sh
          </pre>
          <p>
            Then refresh your browser at <c>localhost:5000</c> to see the changes.
          </p>
        </li>
      </ol>
    </subsection>

    <subsection xml:id="subsec-mathematical-content">
      <title>Writing Mathematical Content</title>
      <p>
        PreTeXt uses LaTeX for mathematical notation. Here are common patterns:
      </p>

      <paragraphs>
        <title>Inline Math</title>
        <p>
          Use <c>&lt;m&gt;</c> tags for inline math: <m>f(x) = x^2 + 1</m>
        </p>
        <pre>
&lt;p&gt;
  The function &lt;m&gt;f(x) = x^2 + 1&lt;/m&gt; is continuous.
&lt;/p&gt;
        </pre>
      </paragraphs>

      <paragraphs>
        <title>Display Math</title>
        <p>
          Use <c>&lt;me&gt;</c> for displayed equations:
        </p>
        <me>
          \int_a^b f(x) \, dx = F(b) - F(a)
        </me>
        <pre>
&lt;me&gt;
  \int_a^b f(x) \, dx = F(b) - F(a)
&lt;/me&gt;
        </pre>
      </paragraphs>

      <paragraphs>
        <title>Theorems and Definitions</title>
        <pre>
&lt;theorem xml:id="thm-fundamental"&gt;
  &lt;title&gt;Fundamental Theorem of Calculus&lt;/title&gt;
  &lt;statement&gt;
    &lt;p&gt;
      If &lt;m&gt;f&lt;/m&gt; is continuous on &lt;m&gt;[a,b]&lt;/m&gt;...
    &lt;/p&gt;
  &lt;/statement&gt;
&lt;/theorem&gt;
        </pre>
      </paragraphs>
    </subsection>

    <subsection xml:id="subsec-linking-notes">
      <title>Linking Notes (Zettelkasten Method)</title>
      <p>
        Connect related notes using cross-references:
      </p>
      <pre>
&lt;p&gt;
  This builds on the concept from &lt;xref ref="sec-topology-intro"/&gt;.
&lt;/p&gt;
      </pre>
      <p>
        The <c>ref</c> attribute should match the <c>xml:id</c> of the section you want to link to.
      </p>
    </subsection>

    <subsection xml:id="subsec-citations">
      <title>Adding Citations</title>
      <p>
        To cite a source, first add it to <c>backmatter.ptx</c>:
      </p>
      <pre>
&lt;biblio type="raw" xml:id="rudin1976"&gt;
  Rudin, Walter. Principles of Mathematical Analysis. 
  McGraw-Hill, 1976.
&lt;/biblio&gt;
      </pre>
      <p>
        Then cite it in your content:
      </p>
      <pre>
&lt;p&gt;
  For more details, see &lt;xref ref="rudin1976"/&gt;.
&lt;/p&gt;
      </pre>
    </subsection>

    <subsection xml:id="subsec-workflow-tips">
      <title>Recommended Workflow</title>
      <ol>
        <li>
          <p>
            <term>Start with rough ideas</term> <mdash/> Add them to the Prototypes chapter
          </p>
        </li>
        <li>
          <p>
            <term>Build incrementally</term> <mdash/> Add small sections often, don't wait for perfection
          </p>
        </li>
        <li>
          <p>
            <term>Link as you go</term> <mdash/> Use <c>&lt;xref&gt;</c> to connect related concepts
          </p>
        </li>
        <li>
          <p>
            <term>Reorganize later</term> <mdash/> Move mature notes from Prototypes to Explanations or Reference
          </p>
        </li>
        <li>
          <p>
            <term>Commit frequently</term> <mdash/> Use Git to track your progress and changes
          </p>
        </li>
      </ol>
    </subsection>

    <subsection xml:id="subsec-quick-reference">
      <title>Quick Reference</title>
      <p>
        Common commands you'll use:
      </p>
      <table>
        <title>Common Commands</title>
        <tabular halign="left">
          <row header="yes" bottom="medium">
            <cell>Command</cell>
            <cell>Purpose</cell>
          </row>
          <row>
            <cell><c>./build.sh</c></cell>
            <cell>Build project with custom CSS</cell>
          </row>
          <row>
            <cell><c>git add .</c></cell>
            <cell>Stage all changes</cell>
          </row>
          <row>
            <cell><c>git commit -m "message"</c></cell>
            <cell>Save changes with message</cell>
          </row>
          <row>
            <cell><c>git push</c></cell>
            <cell>Upload to GitHub</cell>
          </row>
        </tabular>
      </table>
    </subsection>
  </section>
</chapter>
